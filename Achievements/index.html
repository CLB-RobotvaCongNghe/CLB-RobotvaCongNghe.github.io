<!doctype html>
<html lang="vi">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b1020" />
  <title>Th√†nh t√≠ch ‚Äî CLB Robot & C√¥ng ngh·ªá (UNETI)</title>
  <meta name="description" content="T·ªïng h·ª£p cu·ªôc thi tham gia, gi·∫£i th∆∞·ªüng v√† d·ª± √°n n·ªïi b·∫≠t." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="../styles.css" />
</head>

<body class="page-achievements">
  <div id="top"></div>

  <div class="bg">
    <div class="blob b1"></div>
    <div class="blob b2"></div>
    <div class="grid"></div>
    <canvas id="stars" aria-hidden="true"></canvas>
  </div>

  <header class="topbar">
    <div class="container topbar__inner">
      <a class="brand" href="../" aria-label="V·ªÅ trang ch·ªß">
        <img src="../assets/logo.jpg" alt="Logo CLB Robot & C√¥ng ngh·ªá" class="brand__logo" />
        <div class="brand__text">
          <div class="brand__name">CLB Robot & C√¥ng ngh·ªá</div>
          <div class="brand__sub">Khoa ƒêi·ªán & T·ª± ƒë·ªông ho√° ‚Äî UNETI</div>
        </div>
      </a>

      <nav class="nav" aria-label="ƒêi·ªÅu h∆∞·ªõng">
        <button class="nav__toggle" id="navToggle" aria-label="M·ªü menu" aria-expanded="false">
          <i class="fa-solid fa-bars"></i>
        </button>
        <ul class="nav__list" id="navList">
          <li><a class="nav__link" href="../#gioi-thieu">Gi·ªõi thi·ªáu</a></li>
          <li><a class="nav__link" href="../#hoat-dong">Ho·∫°t ƒë·ªông</a></li>
          <li><a class="nav__link" href="../#san-choi">S√¢n ch∆°i</a></li>
          <li><a class="nav__link" href="../Members/">Th√†nh vi√™n</a></li>
          <li><a class="nav__link active" href="../Achievements/">Th√†nh t√≠ch</a></li>
          <li><a class="nav__link" href="../Competitions-Organized/">T·ªï ch·ª©c gi·∫£i</a></li>
          <li><a class="nav__link" href="../#lien-he">Li√™n h·ªá</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero hero--ach" style="padding-bottom: 14px;">
      <div class="container hero__grid" style="grid-template-columns: 1fr;">
        <div class="hero__left reveal">
          <div class="chips">
            <span class="chip"><i class="fa-solid fa-link"></i> /Achievements</span>
            <span class="chip"><i class="fa-solid fa-house"></i>
              <a href="../" style="text-decoration:underline; text-underline-offset:4px;">Trang ch·ªß</a>
            </span>
          </div>

          <h1 class="hero__title">üèÖ Th√†nh t√≠ch <span class="accent">‚öôÔ∏è</span></h1>
          <p class="hero__subtitle">T·ªïng h·ª£p cu·ªôc thi tham gia, gi·∫£i th∆∞·ªüng v√† d·ª± √°n n·ªïi b·∫≠t.</p>

          <div class="hero__cta">
            <a class="btn btn--ghost" href="../">
              <i class="fa-solid fa-arrow-left"></i> Quay v·ªÅ trang ch·ªß
            </a>
            <a class="btn btn--primary" href="../#tham-gia">
              <i class="fa-solid fa-user-plus"></i> Tham gia CLB
            </a>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="achievements" style="padding: 0px;">
      <div class="container">

        <!-- Summary (tu·ª≥ ch·ªçn) -->
        <div id="achSummary" class="grid2" style="margin-top: 10px;"></div>

        <!-- Filters -->
        <div class="achFilters reveal" style="margin-top:14px;">
          <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
            <span class="tag"><i class="fa-solid fa-filter"></i> L·ªçc</span>

            <select id="yearFilter" class="achControl">
              <option value="__all__">T·∫•t c·∫£ nƒÉm</option>
            </select>

            <select id="typeFilter" class="achControl">
              <option value="__all__">T·∫•t c·∫£ lo·∫°i</option>
              <option value="competition">Cu·ªôc thi</option>
              <option value="award">Gi·∫£i th∆∞·ªüng / D·∫•u m·ªëc</option>
              <option value="project">D·ª± √°n</option>
            </select>

            <div class="achSearch">
              <i class="fa-solid fa-magnifying-glass"></i>
              <input id="achSearch" type="search" placeholder="T√¨m theo cu·ªôc thi/gi·∫£i/vai tr√≤/nƒÉm..." />
            </div>
          </div>
        </div>

        <!-- Render -->
        <div id="achContent" class="achContent"></div>

        <div id="achEmpty" class="panel" style="margin-top:12px; display:none;">
          <h3 style="margin:0 0 8px;">Kh√¥ng c√≥ d·ªØ li·ªáu</h3>
          <p style="margin:0; color: rgba(234,240,255,.72); line-height:1.6;">
            Ki·ªÉm tra <b>Achievements/achievements.json</b> ho·∫∑c ch·∫°y site b·∫±ng server (kh√¥ng m·ªü file:///).
          </p>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer__inner">
      <div>
        ¬© <span id="year"></span> CLB Robot & C√¥ng ngh·ªá ‚Äî UNETI ‚Ä¢ Design by
        <a class="link" href="https://github.com/TranDangKhoaTechnology" target="_blank" rel="noopener">Tr∆∞·ªüng Ban Kƒ© Thu·∫≠t</a>
      </div>
      <div class="footer__right">
        <a class="link" href="#top">V·ªÅ ƒë·∫ßu trang ‚Üë</a>
      </div>
    </div>
  </footer>

  <button class="toTop" id="toTop" aria-label="L√™n ƒë·∫ßu trang">
    <i class="fa-solid fa-arrow-up"></i>
  </button>

  <script src="../script.js"></script>

  <!-- ‚úÖ Image Modal: PH·∫¢I ƒë·∫∑t TR∆Ø·ªöC script x·ª≠ l√Ω modal -->
  <div id="imgModal" class="imgModal" aria-hidden="true">
    <div class="imgModal__backdrop" data-close="1"></div>

    <div class="imgModal__panel" role="dialog" aria-modal="true" aria-label="Xem ·∫£nh">
      <button class="imgModal__close" type="button" aria-label="ƒê√≥ng" data-close="1">
        <i class="fa-solid fa-xmark"></i>
      </button>

      <button class="imgModal__nav imgModal__prev" type="button" aria-label="·∫¢nh tr∆∞·ªõc" data-nav="prev">
        <i class="fa-solid fa-chevron-left"></i>
      </button>

      <button class="imgModal__nav imgModal__next" type="button" aria-label="·∫¢nh sau" data-nav="next">
        <i class="fa-solid fa-chevron-right"></i>
      </button>

      <div id="imgModalCounter" class="imgModal__counter">1 / 1</div>

      <img id="imgModalView" class="imgModal__img" src="" alt="·∫¢nh" />
    </div>
  </div>

  <!-- Render achievements.json -->
  <script>
    (function () {
      var summary = document.getElementById("achSummary");
      var host = document.getElementById("achContent");
      var emptyBox = document.getElementById("achEmpty");

      var yearFilter = document.getElementById("yearFilter");
      var typeFilter = document.getElementById("typeFilter");
      var searchInput = document.getElementById("achSearch");

      function esc(s) {
        return String(s || "")
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      }
      function norm(s) { return String(s || "").toLowerCase().trim(); }

      function typeLabel(t) {
        if (t === "competition") return "Cu·ªôc thi";
        if (t === "award") return "Gi·∫£i / D·∫•u m·ªëc";
        if (t === "project") return "D·ª± √°n";
        return "Kh√°c";
      }

      function buildSummary(items) {
        // tu·ª≥ ch·ªçn: n·∫øu mu·ªën hi·ªÉn th·ªã summary th√¨ m·ªü comment
        // var total = items.length;
        // var c = items.filter(x => x.type === "competition").length;
        // var a = items.filter(x => x.type === "award").length;
        // var p = items.filter(x => x.type === "project").length;
        // summary.innerHTML =
        //   '<div class="feature reveal"><div class="feature__top"><h3><i class="fa-solid fa-chart-line"></i> T·ªïng m·ª•c</h3><span class="tag">All</span></div>' +
        //   '<p style="margin:8px 0 0; color: rgba(234,240,255,.78);">T·ªïng c·ªông <b>' + total + '</b> m·ª•c.</p></div>' +
        //   '<div class="feature reveal"><div class="feature__top"><h3>üèÅ Cu·ªôc thi</h3><span class="tag">' + c + '</span></div></div>' +
        //   '<div class="feature reveal"><div class="feature__top"><h3>üèÖ Gi·∫£i / D·∫•u m·ªëc</h3><span class="tag">' + a + '</span></div></div>' +
        //   '<div class="feature reveal"><div class="feature__top"><h3>‚ú® D·ª± √°n</h3><span class="tag">' + p + '</span></div></div>';
      }

      function imagesHTML(images) {
        if (!Array.isArray(images) || !images.length) return "";
        var thumbs = images.slice(0, 8).map(function (src) {
          return (
            '<button class="achThumbBtn" type="button" data-img="' + esc(src) + '" aria-label="Xem ·∫£nh">' +
              '<img src="' + esc(src) + '" alt="·∫¢nh minh ho·∫°">' +
            '</button>'
          );
        }).join("");
        return '<div class="achGallery">' + thumbs + '</div>';
      }

      function linksHTML(links) {
        if (!Array.isArray(links) || !links.length) return "";
        return '<div class="achLinks">' + links.map(function (l) {
          return '<a class="btn btn--ghost achLinkBtn" href="' + esc(l.href) + '" target="_blank" rel="noopener">' +
            '<i class="fa-solid fa-arrow-up-right-from-square"></i> ' + esc(l.label || "Link") +
          '</a>';
        }).join("") + '</div>';
      }

      function itemCardHTML(it) {
        var year = esc(it.year);
        var comp = esc(it.competition || it.title || "Ho·∫°t ƒë·ªông");
        var award = esc(it.award || "");
        var team = esc(it.team || "");
        var role = esc(it.role || "");
        var loc = esc(it.location || "");
        var desc = esc(it.description || "");
        var t = esc(typeLabel(it.type));

        return (
          '<article class="card achCard tilt" data-tilt>' +
            '<div class="achCardTop">' +
              '<div class="achTitle">' +
                '<div class="achName">' + comp + '</div>' +
                '<div class="achMeta">' +
                  '<span class="achBadge"><i class="fa-solid fa-tag"></i> ' + t + '</span>' +
                  '<span class="achBadge"><i class="fa-solid fa-calendar"></i> ' + year + '</span>' +
                '</div>' +
              '</div>' +
            '</div>' +

            (award ? ('<div class="achLine"><i class="fa-solid fa-trophy"></i><b>' + award + '</b></div>') : '') +
            (team ? ('<div class="achLine"><i class="fa-solid fa-people-group"></i><span>' + team + '</span></div>') : '') +
            (role ? ('<div class="achLine"><i class="fa-solid fa-screwdriver-wrench"></i><span>' + role + '</span></div>') : '') +
            (loc ? ('<div class="achLine"><i class="fa-solid fa-location-dot"></i><span>' + loc + '</span></div>') : '') +
            (desc ? ('<p class="achDesc">' + desc + '</p>') : '') +

            imagesHTML(it.images) +
            linksHTML(it.links) +
          '</article>'
        );
      }

      function groupByYear(items) {
        var map = {};
        items.forEach(function (it) {
          var y = String(it.year || "");
          if (!map[y]) map[y] = [];
          map[y].push(it);
        });
        return map;
      }

      function render(items, yf, tf, q) {
        host.innerHTML = "";
        var qn = norm(q);

        var filtered = items.filter(function (it) {
          if (yf !== "__all__" && String(it.year) !== String(yf)) return false;
          if (tf !== "__all__" && String(it.type) !== String(tf)) return false;

          if (!qn) return true;
          var hay = [
            it.year, it.type, it.competition, it.award, it.team, it.role, it.location, it.description
          ].map(norm).join(" | ");
          return hay.indexOf(qn) !== -1;
        });

        if (!filtered.length) {
          emptyBox.style.display = "block";
          return;
        }
        emptyBox.style.display = "none";

        filtered.sort(function (a, b) {
          return (Number(b.year) || 0) - (Number(a.year) || 0);
        });

        var byYear = groupByYear(filtered);
        var years = Object.keys(byYear).sort(function (a, b) { return Number(b) - Number(a); });

        years.forEach(function (y) {
          host.insertAdjacentHTML("beforeend",
            '<div class="achYearHead">' +
              '<h3 class="section__title" style="font-size:1.4rem; margin:0;">üìå NƒÉm ' + esc(y) + '</h3>' +
              '<div class="achYearCount">' + byYear[y].length + ' m·ª•c</div>' +
            '</div>' +
            '<div class="cards">' +
              byYear[y].map(itemCardHTML).join("") +
            '</div>'
          );
        });
      }

      fetch("./achievements.json", { cache: "no-store" })
        .then(function (r) { return r.json(); })
        .then(function (data) {
          var items = Array.isArray(data && data.items) ? data.items : [];
          if (!items.length) { emptyBox.style.display = "block"; return; }

          buildSummary(items);

          var years = Array.from(new Set(items.map(function (x) { return x.year; })))
            .filter(Boolean)
            .sort(function (a, b) { return b - a; });

          yearFilter.innerHTML = ['<option value="__all__">T·∫•t c·∫£ nƒÉm</option>']
            .concat(years.map(function (y) { return '<option value="' + esc(y) + '">' + esc(y) + '</option>'; }))
            .join("");

          function apply() {
            render(items, yearFilter.value, typeFilter.value, searchInput.value);
          }

          yearFilter.addEventListener("change", apply);
          typeFilter.addEventListener("change", apply);
          searchInput.addEventListener("input", apply);

          apply();
        })
        .catch(function () {
          emptyBox.style.display = "block";
        });
    })();
  </script>

  <!-- ‚úÖ Modal logic: click ·∫£nh -> m·ªü modal, c√≥ prev/next + ph√≠m m≈©i t√™n -->
  <script>
    (function () {
      var modal = document.getElementById("imgModal");
      var imgView = document.getElementById("imgModalView");
      var counter = document.getElementById("imgModalCounter");

      var list = [];
      var idx = 0;

      function setImg() {
        if (!imgView || !list.length) return;
        imgView.src = list[idx];
        if (counter) counter.textContent = (idx + 1) + " / " + list.length;
      }

      function openModal(imgList, startIndex) {
        if (!modal || !imgView) return;

        list = Array.isArray(imgList) ? imgList : [];
        idx = Math.max(0, Math.min(Number(startIndex) || 0, list.length - 1));

        setImg();
        modal.classList.add("is-open");
        modal.setAttribute("aria-hidden", "false");
        document.body.classList.add("noScroll");
      }

      function closeModal() {
        if (!modal || !imgView) return;
        modal.classList.remove("is-open");
        modal.setAttribute("aria-hidden", "true");
        imgView.src = "";
        if (counter) counter.textContent = "";
        list = [];
        idx = 0;
        document.body.classList.remove("noScroll");
      }

      function step(dir) {
        if (!list.length) return;
        idx = (idx + dir + list.length) % list.length; // v√≤ng tr√≤n
        setImg();
      }

      document.addEventListener("click", function (e) {
        // Click thumbnail
        var btn = e.target.closest(".achThumbBtn");
        if (btn && btn.dataset && btn.dataset.img) {
          e.preventDefault();

          var gallery = btn.closest(".achGallery");
          var buttons = gallery ? gallery.querySelectorAll(".achThumbBtn[data-img]") : [btn];
          var imgs = Array.prototype.map.call(buttons, function (b) { return b.dataset.img; }).filter(Boolean);

          var start = imgs.indexOf(btn.dataset.img);
          openModal(imgs, start >= 0 ? start : 0);
          return;
        }

        // Prev/Next
        var nav = e.target.closest("[data-nav]");
        if (nav) {
          e.preventDefault();
          step(nav.dataset.nav === "next" ? 1 : -1);
          return;
        }

        // Close
        if (e.target.closest('[data-close="1"]')) {
          closeModal();
        }
      });

      // ESC / Arrow keys
      document.addEventListener("keydown", function (e) {
        if (!modal || !modal.classList.contains("is-open")) return;

        if (e.key === "Escape") closeModal();
        if (e.key === "ArrowRight") step(1);
        if (e.key === "ArrowLeft") step(-1);
      });
    })();
  </script>

  <style>
    /* Filters */
    .achFilters{
      padding: 14px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(9,14,30,.55);
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
    }

    .achControl{
      height: 44px;
      border-radius: 14px;
      padding: 0 12px;
      color: rgba(234,240,255,.92);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      outline: none;
    }

    .achSearch{
      flex: 1 1 auto;
      min-width: min(420px, 100%);
      display:flex;
      align-items:center;
      gap: 10px;
      height: 44px;
      padding: 0 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
    }
    .achSearch i{ opacity:.7; }
    .achSearch input{
      width:100%;
      border:0;
      outline:0;
      background: transparent;
      color: rgba(234,240,255,.92);
      font: inherit;
    }

    /* Year head */
    .achYearHead{
      margin-top: 18px;
      margin-bottom: 10px;
      display:flex;
      align-items:flex-end;
      justify-content: space-between;
      gap: 12px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .achYearCount{
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color: rgba(234,240,255,.78);
      font-size: .92rem;
      white-space: nowrap;
    }

    /* Card */
    .achCard{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(10,14,28,.55);
      box-shadow: 0 18px 45px rgba(0,0,0,.45);
      transition: transform .18s ease, border-color .18s ease;
    }
    .achCard:hover{
      transform: translateY(-3px);
      border-color: rgba(255,255,255,.18);
    }

    .achName{
      font-weight: 700;
      font-size: 1.08rem;
      letter-spacing: .2px;
      overflow-wrap:anywhere;
      word-break: break-word;
    }

    .achMeta{
      margin-top: 8px;
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      color: rgba(234,240,255,.72);
      font-size: .92rem;
    }
    .achBadge{
      display:inline-flex;
      gap: 8px;
      align-items:center;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
    }

    .achLine{
      margin-top: 10px;
      display:flex;
      gap: 10px;
      align-items:flex-start;
      color: rgba(234,240,255,.78);
      line-height: 1.45;
    }
    .achLine i{ opacity:.75; margin-top: 2px; }

    .achDesc{
      margin: 10px 0 0;
      color: rgba(234,240,255,.72);
      line-height: 1.6;
    }

    /* Gallery */
    .achGallery{
      margin-top: 12px;
      display:grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 10px;
    }
    @media (max-width: 740px){
      .achGallery{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .achSearch{ min-width: 100%; }
    }

    .achThumbBtn{
      display:block;
      width: 100%;
      padding: 0;
      border: 0;
      background: transparent;
      border-radius: 14px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.12);
      cursor: zoom-in;
      transition: transform .14s ease, border-color .14s ease;
    }
    .achThumbBtn:hover{
      transform: translateY(-2px);
      border-color: rgba(255,255,255,.18);
    }
    .achThumbBtn img{
      width:100%;
      height: 92px;
      object-fit: cover;
      display:block;
    }

    .achLinks{
      margin-top: 12px;
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .achLinkBtn{ padding: 10px 12px; }

    /* Modal */
    .noScroll{ overflow: hidden; }

    .imgModal{
      position: fixed;
      inset: 0;
      z-index: 9999;
      display: none;
    }
    .imgModal.is-open{ display:block; }

    .imgModal__backdrop{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,.65);
      backdrop-filter: blur(6px);
    }

    .imgModal__panel{
      position: relative;
      z-index: 1;
      width: min(980px, calc(100% - 24px));
      margin: 6vh auto 0;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(10,14,28,.75);
      box-shadow: 0 30px 80px rgba(0,0,0,.6);
      overflow: hidden;
    }

    .imgModal__img{
      display:block;
      width: 100%;
      height: auto;
      max-height: 78vh;
      object-fit: contain;
      background: rgba(0,0,0,.25);
    }

    .imgModal__close{
      position:absolute;
      top:10px;
      right:10px;
      width: 42px;
      height: 42px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      color: rgba(234,240,255,.92);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      z-index: 3;
    }

    .imgModal__nav{
      position:absolute;
      top:50%;
      transform: translateY(-50%);
      width: 46px;
      height: 46px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      color: rgba(234,240,255,.92);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      z-index: 3;
    }
    .imgModal__prev{ left: 10px; }
    .imgModal__next{ right: 10px; }

    .imgModal__counter{
      position:absolute;
      left: 10px;
      bottom: 10px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      color: rgba(234,240,255,.88);
      font-size: .92rem;
      z-index: 3;
    }
  </style>
</body>

</html>
